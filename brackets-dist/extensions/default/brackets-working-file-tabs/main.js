define("main",["require","exports","module"],function(e,n,t){function i(){h.set("enabled",!h.get("enabled")),h.save(),c.get(p).setChecked(h.get("enabled")),s()}function s(){h.get("enabled")?o():r()}function o(){if(!$("#working-file-tabs-container").length){var e=$("<div>",{id:"working-file-tabs-container","class":"working-file-tabs-container end-left"}),n=$("<div>",{id:"working-file-tabs-scroll-container","class":"working-file-tabs-scroll-container"});e.append(n);var t=$("#working-set-list-container");t.appendTo(n);var i=$("#sidebar"),s=i.find(".working-set-splitview-btn"),o=i.find(".working-set-option-btn");s.appendTo(e),o.appendTo(e);var r=$("<div>",{"class":"btn-alt-quiet working-file-tabs-scroll left",html:"<span>◀</span>"}),l=$("<div>",{"class":"btn-alt-quiet working-file-tabs-scroll right",html:"<span>▶</span>"});e.append(r),e.append(l);var c=$("#editor-holder");c.before(e),a()}}function r(){if($("#working-file-tabs-container").length){var e=$("#working-set-list-container"),n=e.find(".working-set-view"),t=$("#working-file-tabs-container"),i=$("#project-files-header"),s=($("#sidebar"),t.find(".working-set-splitview-btn")),o=t.find(".working-set-option-btn");i.before(e),e.removeAttr("style"),n.removeAttr("style"),e.before(s),e.before(o),t.remove()}}function a(e){if(h.get("enabled")){var n=$("#working-set-list-container"),t=n.find(".working-set-view"),i=0,s=0;$.each(t,function(e,n){var t=$(n),o=0,r=t.find("li");$.each(r,function(e,n){o+=$(n).outerWidth(!0),i+=$(n).outerWidth(!0),s+=1}),t.css("width",o+1)}),n.css("width",i+10),1>s&&n.css("left",0).css("right","auto");var o=$("#working-file-tabs-container"),r=$("#working-file-tabs-scroll-container");r.width()<n.width()?o.addClass("scroll"):o.removeClass("scroll"),"undefined"!=typeof e&&e()}}function l(e){if(h.get("enabled")){var n=$("#working-file-tabs-container"),t=$("#working-file-tabs-scroll-container"),i=n.hasClass("scroll")?!0:!1;if(i){var s=$("#working-set-list-container"),o=t.outerWidth()-$("#working-set-list-container").outerWidth(),r=parseInt(s.css("left"),10);switch(n.removeClass("end-left").removeClass("end-right"),e){case"left":r+k.scrollSize<0?s.css("left",r+k.scrollSize+"px"):(s.css("left",0),n.addClass("end-left"));break;case"right":r-k.scrollSize>=o?s.css("left",r-k.scrollSize+"px"):(s.css("left",o),n.addClass("end-right"));break;case"active":var a=s.find(".selected").last()[0],l=$(a).position(),c=-1*l.left;c>=o?s.css("left",c):(s.css("left",o),n.addClass("end-right"));break;case"last":s.css("left",o),n.addClass("end-right")}}}}var c=brackets.getModule("command/CommandManager"),d=brackets.getModule("command/Menus"),f=brackets.getModule("project/ProjectManager"),g=brackets.getModule("preferences/PreferencesManager"),b=brackets.getModule("view/MainViewManager"),u=brackets.getModule("view/WorkspaceManager"),w=brackets.getModule("utils/ExtensionUtils"),k={scrollSize:30,scrollContinue:null,scrollSpeed:50,scrolling:!1};w.loadStyleSheet(t,"less/main.less");var v="Show Working Files as Tabs",p="brackets-view.working-file-tabs";c.register(v,p,i),d.getMenu(d.AppMenuBar.VIEW_MENU).addMenuItem(p);var h=g.getExtensionPrefs("brackets-working-file-tabs");h.definePreference("enabled","boolean",!1),c.get(p).setChecked(h.get("enabled")),$(f).on("projectOpen projectRefresh",s),b.on("paneLayoutChange",function(e,n){$("#working-file-tabs-container").addClass(n.toLowerCase())}).on("workingSetAdd",function(){a(function(){l("last")}),k.scrolling=!0}).on("workingSetRemove",function(){a(function(){l("active")}),k.scrolling=!0}),u.on("workspaceUpdateLayout",function(){k.scrolling||a(function(){l("active")}),k.scrolling=!1}),$("body").on("mousedown",".working-file-tabs-scroll",function(){var e=$(this),n=e.hasClass("left")?"left":"right";k.scrollContinue=setInterval(function(){l(n)},k.scrollSpeed)}).bind("mouseup mouseleave",".working-file-tabs-scroll",function(){clearInterval(k.scrollContinue),k.scrollContinue=null}),$("body").on("mousedown",".working-file-tabs-container",function(e){return $(e.target).hasClass(".working-file-tabs-container")?!1:void 0})});